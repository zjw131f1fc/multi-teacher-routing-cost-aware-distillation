# Step1: 收集学生模型的 NTE 分数配置

global_settings:
  seed: 42
  device: "cuda"
  dtype: "half"
  pytorch_cuda_alloc_conf: "expandable_segments:True"
  dataset_cache_dir: "/data/users/zjw/dataset_cache"
  hf_cache_dir: "/data/users/zjw/huggingface_cache"
  study_name: "step1_collect_scores"  # 用于日志和输出文件命名

config_settings:
  enable_dict_overrides: true
  enable_yaml_overrides: true
  log_config_on_load: true

dataset_settings:
  type: "distill"
  name: "distill-openr1-math"
  distill_settings:
    split:
      train: 'all'

backbone_settings:
  type: "llm"
  name: "qwen2.5-0.5b-instruct"
  llm_settings:
    device_map: "balanced"  # 自动多卡分配
    # max_tokens: 512

method_settings:
  # Study name (用于日志标识，不影响输出文件路径)
  study_name: "step1_collect_scores"

  # Data filtering
  required_teachers:
    - "deepseek-r1"
    - "qwen2.5-math-7b-instruct"

  # NTE Score 参数
  nte_alpha: 3.0  # Beta 分布参数 α (Proximity计算：控制对高likelihood的偏好)
  nte_beta: 1.0   # Beta 分布参数 β (Proximity计算：控制区分度)

  # NTE 线性组合权重（简化版）: NTE = (quality × w_q + proximity × w_p) × 10
  nte_quality_weight: 0.6     # 质量分数的权重 w_q (default=0.7, 主要看质量)
  nte_proximity_weight: 0.4   # 可学习性分数的权重 w_p (default=0.3, 辅助区分)
  # 注意: quality_weight + proximity_weight 应该 = 1.0
  # 如果只关心质量: w_q=1.0, w_p=0.0
  # 如果只关心可学习性: w_q=0.0, w_p=1.0

  # 质量分数的 reward key
  reward_key: "math_verify"  # 从 rewards 中提取哪个 key 作为质量分数

  # 处理控制
  max_samples: null  # null = 处理所有样本，设置数字可以限制处理数量（用于调试）
